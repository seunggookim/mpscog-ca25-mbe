function [factorscores, factorperctiles, factornames] = computebmrq20factorscores(ratings)
% This is a MATLAB translation of the Execel version calculator, which I've
%   got from the author (Josep Marco-Pallares [josepmarco at gmail.com]).
%   __INTERNAL USE ONLY__
%
% USAGE
% [factorscores, factornames] = computebmrqfactorscores(ratings)
%
% 2020, sgKIM. solleo@gmail.com
%
% REF: http://brainvitge.org/z_oldsite/bmrq.php
assert(min(ratings)>0, 'Scales seem 0-based! | expecting 1-based scales')
for i = 1:20
  eval(sprintf('i%i=ratings(%i);',i,i))
end

a1=(i1-3.85180)/0.90570;
a2=(i2-1.72700)/1.06350;
a3=(i3-4.34420)/0.83540;
a4=(i4-4.17040)/0.94910;
a5=(i5-1.64880)/1.05530;
a6=(i6-3.74210)/0.89520;
a7=(i7-3.88800)/0.97830;
a8=(i8-4.53210)/0.68650;
a9=(i9-4.26140)/0.81850;
a10=(i10-3.95800)/1.06150;
a11=(i11-3.45510)/1.08970;
a12=(i12-3.55190)/1.27980;
a13=(i13-3.27650)/1.30490;
a14=(i14-4.34660)/0.80310;
a15=(i15-4.28940)/0.99190;
a16=(i16-3.81680)/0.94980;
a17=(i17-2.28590)/1.13310;
a18=(i18-3.94400)/0.97470;
a19=(i19-4.11550)/0.86440;
a20=(i20-3.99650)/0.99350;

MS=-(0.0055*a1)-(0.4190*a2)+(0.0376*a3)+(0.1086*a4)+(0.0038*a5)+(0.0460*a6)+(0.2751*a7)-(0.0151*a8)-(0.0607*a9)-(0.0401*a10)+(0.4148*a11)-(0.0250*a12)-(0.0423*a13)+(0.0159*a14)+(0.0937*a15)+(0.0536*a16)+(0.2106*a17)+(0.0083*a18)-(0.0603*a19)+(0.0025*a20);
EE=(0.0236*a1)-(0.0099*a2)+(0.2998*a3)+(0.0198*a4)-(0.0517*a5)-(0.0033*a6)+(0.0105*a7)+(0.2989*a8)+(0.0222*a9)-(0.0242*a10)-(0.0492*a11)+(0.3307*a12)+(0.0006*a13)-(0.0254*a14)+(0.0187*a15)-(0.0175*a16)+(0.0601*a17)+(0.3598*a18)+(0.0271*a19)-(0.0077*a20);
MR=(0.0336*a1)-(0.0630*a2)+(0.0536*a3)+(0.2432*a4)+(0.1130*a5)-(0.0486*a6)+(0.0122*a7)+(0.0620*a8)+(0.3327*a9)-(0.0282*a10)-(0.0336*a11)-(0.1296*a12)-(0.0248*a13)+(0.3776*a14)+(0.1671*a15)+(0.0534*a16)-(0.1572*a17)-(0.0384*a18)+(0.2663*a19)+(0.0290*a20);
SM=-(0.0602*a1)+(0.0557*a2)-(0.0036*a3)+(0.0163*a4)-(0.3377*a5)+(0.0494*a6)+(0.0258*a7)-(0.0127*a8)+(0.0107*a9)+(0.4263*a10)+(0.0645*a11)+(0.0838*a12)-(0.0048*a13)+(0.0110*a14)+(0.1481*a15)+(0.0266*a16)-(0.0631*a17)-(0.0440*a18)-(0.0042*a19)+(0.3077*a20);
SC=(0.3566*a1)-(0.0714*a2)-(0.1191*a3)-(0.0804*a4)-(0.1072*a5)+(0.3277*a6)-(0.1801*a7)-(0.0092*a8)-(0.0121*a9)-(0.0818*a10)-(0.0978*a11)+(0.0338*a12)+(0.4228*a13)-(0.0646*a14)-(0.1048*a15)+(0.2254*a16)+(0.2533*a17)+(0.0281*a18)+(0.1319*a19)-(0.0015*a20);
RW=(0.0782*a1)-(0.1236*a2)+(0.0978*a3)+(0.102*a4)-(0.1021*a5)+(0.0821*a6)+(0.0489*a7)+(0.1089*a8)+(0.1039*a9)+(0.0856*a10)+(0.0755*a11)+(0.0913*a12)+(0.0734*a13)+(0.1108*a14)+(0.1061*a15)+(0.0841*a16)+(0.0575*a17)+(0.0955*a18)+(0.1104*a19)+(0.1013*a20);

AMS = (MS*10+50);
AEE = (EE*10+50);
AMR = (MR*10+50);
ASM = (SM*10+50);
ASC = (SC*10+50);
ARW = (RW*10+50);
% all normalized to N(50,10^2)

factorscores = [AMS AEE AMR ASM ASC ARW];
factorperctiles = cdf('norm',factorscores, 50, 10)*100;
factornames = {'MusicSeeking','EmotionEvocation','MoodRegulation','SensoriMotor','SocialReward','OverallMusicReward'};
end
